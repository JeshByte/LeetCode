If we solve the given formula, we will see that for the subsequence to be valid basically the modulo k of alternate elements need to be equal. So when deciding to add a new element to the subsequence we only need the last 2 current elements of the subsequence to make this decision. Thus this is the type of question where to make valid subsequences we just need the last 2 elements. So we will use dp here and its size will be dp[k][k]. dp[i][j] will be the max length of the subsequence ending with i and j modulo k. And the transition will be dp[i][j]=dp[j][i]+1. Thus the max value out of all these states will be the final answer.
